<!DOCTYPE html>
<html>
<head>
  <title>PoIP Staking Simulation</title>
  <script src="https://cdn.jsdelivr.net/npm/ethers@6.6.2/dist/ethers.umd.min.js"></script>
  <style>
    body { font-family: sans-serif; padding: 20px; text-align: center; }
    button { padding: 10px 20px; font-size: 16px; }
    input { padding: 10px; font-size: 16px; width: 100px; text-align: center; }
  </style>
</head>
<body>
  <h1>Stake Simulation â€“ Sepolia Testnet</h1>
  <p>Connect your MetaMask wallet and simulate staking on Sepolia.</p>

  <button onclick="connectWallet()">Connect Wallet</button>
  <p id="wallet-address"></p>

  <p>Enter amount to stake (ETH):</p>
  <input type="number" id="stakeAmount" placeholder="0.01" step="0.01" min="0">
  <br><br>
  <button onclick="stake()">Simulate Stake</button>
  <p id="result"></p>

  <script>
    let provider, signer;

    async function connectWallet() {
      if (window.ethereum) {
        await window.ethereum.request({ method: 'eth_requestAccounts' });
        provider = new ethers.providers.Web3Provider(window.ethereum);
        signer = await provider.getSigner();
        const address = await signer.getAddress();
        document.getElementById("wallet-address").innerText = `Connected: ${address}`;
      } else {
        alert("Please install MetaMask.");
      }
    }

    async function stake() {
      const amount = document.getElementById("stakeAmount").value;
      if (!amount || amount <= 0) {
        document.getElementById("result").innerText = "Enter a valid amount.";
        return;
      }

      document.getElementById("result").innerText = "Simulating transaction...";

      try {
        const tx = await signer.sendTransaction({
          to: signer.getAddress(), // simulate staking to self
          value: ethers.utils.parseEther(amount)
        });

        document.getElementById("result").innerText = `Simulated! TX Hash: ${tx.hash}`;
      } catch (err) {
        document.getElementById("result").innerText = `Error: ${err.message}`;
      }
    }
  </script>
</body>
</html>
